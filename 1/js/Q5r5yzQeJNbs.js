$(function(){$(document).on("click",".favinfo a",function(){var a=$(this).data("url");$("<form/>",{action:a,method:"post",target:"_blank"}).appendTo(document.body).submit()});$(document).on("click","#favinfo a",function(){var b=String($(this).data("bkno"));var c=$(this).data("url");var e=$(this).data("saved");if(e==""){var a=addKentoAndCountForFavinfo(b,c);a.done(function(){alert("お気に入りに追加しました。");window.open("","newwin");$("<form/>",{action:c,method:"post",target:"newwin"}).appendTo(document.body).submit()}).fail(function(){alert("お気に入りに追加できませんでした。")});$("#favinfo > a").each(function(g,h){var f=$(h).attr("mailpush-label");$(h).attr({"data-category":"メール登録","data-action":"遷移","data-label":f})});$("#favinfo > a").data("saved",true);if($("#favinfo > a").data("kr")){var d=parseInt($(".slider__favBtn").attr("favoritedcnt"),10);sliderFavBtnClick(d,false);topFavBtnClick(d,false)}}else{$("<form/>",{action:c,method:"post",target:"_blank"}).appendTo(document.body).submit()}});$.extend({switchFavinfoBtn:function(){if($("#favinfo > a").length){$("#favinfo > a").each(function(b,c){var a=$(c).attr("mailpush-label");$(c).attr({"data-category":"メール登録","data-action":"遷移","data-label":a})});$("#favinfo > a").data("saved",true)}}})});function addKentoAndCountForFavinfo(b,d){if(sendflag){alert("送信中です。");return false}var j=new $.Deferred();var g=$(".btn-fav-unit");var c="/smt/psl/exam/regist";var e=b;var i=document.getElementById("ITEM").value;var f=document.getElementById("ART").value;var a=document.getElementById("SITECD").value;var h=true;sendflag=true;$.ajax({type:"POST",url:c,dataType:"html",data:{BUKKEN:e,ITEM:i,ART:f,SITECD:a,COUNT:h},}).done(function(l){if(l=="0"){j.reject()}else{g.find(".btn-fav-on").css("display","block");g.find(".btn-fav-off").css("display","none");var k=getKentoCount(i);document.getElementById("header_kento_count").innerHTML=k;if(l=="-1"){g.find(".btn-fav-speach").css("display","none")}else{if(document.getElementById("kento_count")!=null){document.getElementById("kento_count").innerHTML=String(l).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}document.getElementById("arcnt").value=("0000"+String(l)).slice(-4)}j.resolve()}}).fail(function(m,k,l){j.reject()});return j.promise()};